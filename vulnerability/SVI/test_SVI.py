# -*- coding: utf-8 -*-
"""
Created on Mon Sep 25 16:33:15 2023

@author: jbousqui
"""
import pandas
from SVI import SVI

# Get all tracts in county
gdf = SVI.get_SVI('12033', year=2020)
# check for columns
check_cols = ['Poverty150', 'Unemploy', 'HouseBurd', 'NoHSDiplo', 'NoHlthIns',
              '65andover', '17andbelow', 'DisableCiv', 'SPH', 'ELP', 'Hisp',
              'Black', 'Asian', 'AIAN', 'NHPI', 'TwoRace', 'OtherRace',
              'MUStruct', 'MobHome', 'Crowd', 'NoVeh', 'GrpQuarter']
for col in check_cols:
    assert col in gdf.columns, f'Missing Column: {col}'
# Test against Tract 1
actual_tract = gdf[gdf['GEOID']=='12033000100']
actual_df = actual_tract[check_cols].reset_index(drop=True)
# Setup expected df
expected_vals = [16.07565011820331,
                 2.9769959404600814,
                 76.77215189873418,
                 20.84388185654008,
                 13.740458015267176,
                 24.699176694110196,
                 19.632678910702978,
                 33.914421553090335,
                 29.599999999999998,
                 1.0570824524312896,
                 2.8499050031665614,
                 28.24572514249525,
                 1.013299556681444,
                 0.253324889170361,
                 4.749841671944269,
                 10.639645345155161,
                 0.0,
                 24.654622741764083,
                 0.4250797024442083,
                 0.7032348804500703,
                 26.160337552742618,
                 4.500330906684315]
expected_dict = {key:[val] for key, val in zip(check_cols, expected_vals)}
expected_df = pandas.DataFrame.from_dict(expected_dict)

pandas.testing.assert_frame_equal(actual_df, expected_df)